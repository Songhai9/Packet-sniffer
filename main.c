#include "packet_capture.h"
#include "packet_analysis.h"

int main(int argc, char *argv[]) {
    if (argc == 1) {
        // Exemple de trame
        uint8_t trame[] = {
            0x01, 0x80, 0xc2, 0x00, 0x00, 0x0e, 0x00, 0x17, 0x5a, 0xa1, 0x41, 0x83, 0x88, 0xcc, 0x02, 0x07,
            0x04, 0x00, 0x17, 0x5a, 0xa1, 0x41, 0x83, 0x04, 0x03, 0x02, 0x01, 0x00, 0x06, 0x02, 0x00, 0x78,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
        };



        // Appeler directement l'analyseur Ethernet
        analyze_ethernet(trame);
    }
    else if (argc == 2) {
        start_packet_capture(argv[1]);
    }
    else {
        fprintf(stderr, "Usage: %s <device>\nExemple: sudo ./packet_analyzer wlp0s20f3\n\n", argv[0]);
        exit(EXIT_FAILURE);
    }

    

    return 0;
}
