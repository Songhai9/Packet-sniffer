\hypertarget{packet__capture_8h}{}\doxysection{include/packet\+\_\+capture.h File Reference}
\label{packet__capture_8h}\index{include/packet\_capture.h@{include/packet\_capture.h}}


Fichier d\textquotesingle{}en-\/tête pour la capture de paquets réseau.  


{\ttfamily \#include $<$pcap.\+h$>$}\newline
Include dependency graph for packet\+\_\+capture.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=218pt]{packet__capture_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{packet__capture_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{packet__capture_8h_a039ca225e8f928cc0a2d82211892393b}{start\+\_\+packet\+\_\+capture}} (char $\ast$device)
\begin{DoxyCompactList}\small\item\em Démarre la capture de paquets sur un périphérique réseau. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{packet__capture_8h_a2403794bd043a246d7e8863122ac5ba6}{packet\+\_\+handler}} (unsigned char $\ast$user\+\_\+data, const struct pcap\+\_\+pkthdr $\ast$pkthdr, const unsigned char $\ast$packet)
\begin{DoxyCompactList}\small\item\em Gère les paquets capturés. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{packet__capture_8h_a8bfc90b3fb9344e9caafec953baacc0b}{handle\+\_\+sigint}} (int sig)
\begin{DoxyCompactList}\small\item\em Gère le signal d\textquotesingle{}interruption (SIGINT) pour terminer proprement la capture. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{packet__capture_8h_ae4e2e6b919474d09e09e997740535366}{open\+\_\+output\+\_\+file}} (const char $\ast$filename)
\begin{DoxyCompactList}\small\item\em Ouvre un fichier pour écrire les données de paquets capturés. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{packet__capture_8h_a7a4f5a7dd803948f7d16fcbb92786aec}{close\+\_\+output\+\_\+file}} ()
\begin{DoxyCompactList}\small\item\em Ferme le fichier de sortie de paquets capturés. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Fichier d\textquotesingle{}en-\/tête pour la capture de paquets réseau. 

Ce fichier contient les déclarations des fonctions utilisées pour la capture et le traitement des paquets réseau. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{packet__capture_8h_a7a4f5a7dd803948f7d16fcbb92786aec}\label{packet__capture_8h_a7a4f5a7dd803948f7d16fcbb92786aec}} 
\index{packet\_capture.h@{packet\_capture.h}!close\_output\_file@{close\_output\_file}}
\index{close\_output\_file@{close\_output\_file}!packet\_capture.h@{packet\_capture.h}}
\doxysubsubsection{\texorpdfstring{close\_output\_file()}{close\_output\_file()}}
{\footnotesize\ttfamily void close\+\_\+output\+\_\+file (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Ferme le fichier de sortie de paquets capturés. 

Ferme le fichier de sortie de paquets capturés.

Cette fonction ferme le fichier ouvert par open\+\_\+output\+\_\+file. Si la fermeture échoue, un message d\textquotesingle{}erreur est affiché. \mbox{\Hypertarget{packet__capture_8h_a8bfc90b3fb9344e9caafec953baacc0b}\label{packet__capture_8h_a8bfc90b3fb9344e9caafec953baacc0b}} 
\index{packet\_capture.h@{packet\_capture.h}!handle\_sigint@{handle\_sigint}}
\index{handle\_sigint@{handle\_sigint}!packet\_capture.h@{packet\_capture.h}}
\doxysubsubsection{\texorpdfstring{handle\_sigint()}{handle\_sigint()}}
{\footnotesize\ttfamily void handle\+\_\+sigint (\begin{DoxyParamCaption}\item[{int}]{sig }\end{DoxyParamCaption})}



Gère le signal d\textquotesingle{}interruption (SIGINT) pour terminer proprement la capture. 


\begin{DoxyParams}{Parameters}
{\em sig} & Le numéro du signal reçu.\\
\hline
\end{DoxyParams}
Gère le signal d\textquotesingle{}interruption (SIGINT) pour terminer proprement la capture.

Cette fonction est appelée lorsque le signal SIGINT est reçu. Elle affiche un message indiquant la fin de l\textquotesingle{}analyse et quitte le programme.


\begin{DoxyParams}{Parameters}
{\em sig} & Le numéro du signal.\\
\hline
\end{DoxyParams}
Signal handler for SIGINT.

This function is called when the SIGINT signal is received. It prints a message indicating the end of the analysis and exits the program.


\begin{DoxyParams}{Parameters}
{\em sig} & The signal number. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{packet__capture_8h_ae4e2e6b919474d09e09e997740535366}\label{packet__capture_8h_ae4e2e6b919474d09e09e997740535366}} 
\index{packet\_capture.h@{packet\_capture.h}!open\_output\_file@{open\_output\_file}}
\index{open\_output\_file@{open\_output\_file}!packet\_capture.h@{packet\_capture.h}}
\doxysubsubsection{\texorpdfstring{open\_output\_file()}{open\_output\_file()}}
{\footnotesize\ttfamily void open\+\_\+output\+\_\+file (\begin{DoxyParamCaption}\item[{const char $\ast$}]{filename }\end{DoxyParamCaption})}



Ouvre un fichier pour écrire les données de paquets capturés. 


\begin{DoxyParams}{Parameters}
{\em filename} & Le nom du fichier à ouvrir pour l\textquotesingle{}écriture.\\
\hline
\end{DoxyParams}
Ouvre un fichier pour écrire les données de paquets capturés.

Cette fonction ouvre un fichier pour écrire les données des paquets. Si aucun nom n\textquotesingle{}est fourni, un nom par défaut est utilisé.


\begin{DoxyParams}{Parameters}
{\em filename} & Le nom du fichier à ouvrir ou NULL pour utiliser un nom par défaut. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{packet__capture_8h_a2403794bd043a246d7e8863122ac5ba6}\label{packet__capture_8h_a2403794bd043a246d7e8863122ac5ba6}} 
\index{packet\_capture.h@{packet\_capture.h}!packet\_handler@{packet\_handler}}
\index{packet\_handler@{packet\_handler}!packet\_capture.h@{packet\_capture.h}}
\doxysubsubsection{\texorpdfstring{packet\_handler()}{packet\_handler()}}
{\footnotesize\ttfamily void packet\+\_\+handler (\begin{DoxyParamCaption}\item[{unsigned char $\ast$}]{user\+\_\+data,  }\item[{const struct pcap\+\_\+pkthdr $\ast$}]{pkthdr,  }\item[{const unsigned char $\ast$}]{packet }\end{DoxyParamCaption})}



Gère les paquets capturés. 

Cette fonction est appelée par pcap\+\_\+loop() à chaque fois qu\textquotesingle{}un paquet est capturé.


\begin{DoxyParams}{Parameters}
{\em user\+\_\+data} & Données utilisateur passées à la fonction. \\
\hline
{\em pkthdr} & En-\/tête du paquet capturé, fourni par pcap. \\
\hline
{\em packet} & Les données du paquet capturé.\\
\hline
\end{DoxyParams}
Gère les paquets capturés.

Cette fonction est appelée pour chaque paquet capturé. Elle affiche des informations sur le paquet, appelle la fonction d\textquotesingle{}analyse Ethernet et affiche les données du paquet.


\begin{DoxyParams}{Parameters}
{\em user\+\_\+data} & Pointeur vers des données définies par l\textquotesingle{}utilisateur (non utilisées dans cette fonction). \\
\hline
{\em pkthdr} & Pointeur vers la structure d\textquotesingle{}en-\/tête du paquet. \\
\hline
{\em packet} & Pointeur vers les données du paquet. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{packet__capture_8h_a039ca225e8f928cc0a2d82211892393b}\label{packet__capture_8h_a039ca225e8f928cc0a2d82211892393b}} 
\index{packet\_capture.h@{packet\_capture.h}!start\_packet\_capture@{start\_packet\_capture}}
\index{start\_packet\_capture@{start\_packet\_capture}!packet\_capture.h@{packet\_capture.h}}
\doxysubsubsection{\texorpdfstring{start\_packet\_capture()}{start\_packet\_capture()}}
{\footnotesize\ttfamily void start\+\_\+packet\+\_\+capture (\begin{DoxyParamCaption}\item[{char $\ast$}]{device }\end{DoxyParamCaption})}



Démarre la capture de paquets sur un périphérique réseau. 


\begin{DoxyParams}{Parameters}
{\em device} & Nom du périphérique réseau sur lequel écouter.\\
\hline
\end{DoxyParams}
Démarre la capture de paquets sur un périphérique réseau.

Ouvre l\textquotesingle{}interface réseau pour la capture en mode promiscuité, définit un gestionnaire de signal pour SIGINT, et démarre la boucle de capture avec pcap\+\_\+loop.


\begin{DoxyParams}{Parameters}
{\em device} & Le nom du périphérique réseau sur lequel écouter. Fonction pour démarrer la capture de paquets.\\
\hline
{\em device} & Le nom de l\textquotesingle{}interface réseau à utiliser pour la capture. \\
\hline
\end{DoxyParams}
